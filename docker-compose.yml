services:
  db2:
    image: icr.io/db2_community/db2:latest
    platform: linux/amd64   
    container_name: db2-community
    privileged: true
    environment:
      LICENSE: accept
      DB2INSTANCE: db2inst1
      DB2INST1_PASSWORD: Passw0rd123!
      DBNAME: SAMPLEDB
      BLU: "false"
      ENABLE_ORACLE_COMPATIBILITY: "false"
      TO_CREATE_SAMPLEDB: "false"
      REPODB: "false"
      IS_OSXFS: "false"
    ports:
      - "50000:50000"
    volumes:
      - db2data:/database
    healthcheck:
      test: ["CMD-SHELL", "su - db2inst1 -c 'db2 connect to SAMPLEDB >/dev/null 2>&1 || exit 1'"]
      interval: 20s
      timeout: 10s
      retries: 20

volumes:
  db2data:
